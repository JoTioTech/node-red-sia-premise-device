<!--
	Copyright (c) since the year 2016 Klaus Landsdorf (http://plus4nodered.com/)
	Copyright 2016 - Jason D. Harper, Argonne National Laboratory
	Copyright 2015,2016 - Mika Karaila, Valmet Automation Inc.
	All rights reserved.
	node-red-contrib-modbus

	@author <a href="mailto:klaus.landsdorf@bianco-royal.de">Klaus Landsdorf</a> (Bianco Royal)
-->
<script type="text/javascript">
	RED.nodes.registerType('SIA-server', {
		category: 'config',
		defaults: {

			name: { value: "" },
			receiverHost: { value: "", required: true },
			receiverPort: { value: "", required: true },
			receiverNumber : { value: "", required: true },
			// siaAccount: { value: "", required: true },
			// siaAccountPrefix: { value: "", required: true },
			encryptionKey: { value: "", required: true },
			encryptionEnabled: { value: false },
			passwordInHex: { value: false },
		},
		label: function () {
			return this.name || 'sia-server@' + this.receiverHost;
		},

		oneditprepare: function () {
			let previous = null;

			if( this.encryptionKey != 32 && this.encryptionKey != 48 && this.encryptionKey != 64 ){ // between 3 and 16 characters
				Node.error('Encryption key must be 128, 192, or 256 bits long (16, 24, or 32 characters)');
			}
			if(!/^[0-9A-Fa-f]+$/.test(this.encryptionKey)){ // hexadecimal characters only
				Node.error('Encryption key must be in hexadecimal characters only (0-9, A-F)');
			}



			// check if encryptionKey is 128 bit 192 or 256 bit long
			// encryptionKey needs to be a hex string



		}
	})
</script>

<script type="text/x-red" data-template-name="SIA-server">
	<div class="form-row">
				<label for="node-config-input-name"><i class="icon-tag"></i> Name</label>
				<input type="text" id="node-config-input-name" placeholder="Name">
		</div>
		<div class="form-row">
				<label for="node-config-input-receiverHost">Receiver IP</label>
				<input type="text" id="node-config-input-receiverHost" placeholder="Receiver Host">
		</div>
		<div class="form-row">
				<label for="node-config-input-receiverPort">Receiver Port</label>
				<input type="number" id="node-config-input-receiverPort" placeholder="Receiver Port">
		</div>
		<div class="form-row">
				<label for="node-config-input-receiverNumber">Receiver Number</label>
				<input type="number" id="node-config-input-receiverNumber" placeholder="Receiver Number">
		</div>
		<!-- <div class="form-row"> -->
		<!-- 		<label for="node-config-input-siaAccount">SIA Account</label> -->
		<!-- 		<input type="text" id="node-config-input-siaAccount" placeholder="SIA Account"> -->
		<!-- </div> -->
		<!-- <div class="form-row"> -->
		<!-- 		<label for="node-config-input-siaAccountPrefix">SIA Account Prefix</label> -->
		<!-- 		<input type="text" id="node-config-input-siaAccountPrefix" placeholder="SIA Account Prefix (empty for none)"> -->
		<!-- </div> -->
		<div class="form-row">
				<label for="node-config-input-encryptionKey">SIA Password</label>
				<input type="password" id="node-config-input-encryptionKey" placeholder="SIA Password">
		</div>
		<div class="form-row">
				<label for="node-config-input-encryptionEnabled">Encryption Enabled</label>
				<input type="checkbox" id="node-config-input-encryptionEnabled" style="display: inline-block; width: auto; vertical-align: middle;">
		</div>
		<div class="form-row">
				<label for="node-config-input-passwordInHex">Password in Hex</label>
				<input type="checkbox" id="node-config-input-passwordInHex" style="display: inline-block; width: auto; vertical-align: middle;">
		</div>
</script>

